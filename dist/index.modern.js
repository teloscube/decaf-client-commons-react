import e,{useEffect as n,useContext as t}from"react";import{buildDecafClient as i}from"@decafhub/decaf-client";import o from"js-cookie";function a(e){return n(()=>{if(!e.zendeskKey)return;const n=document.createElement("script");return n.src="https://static.zdassets.com/ekr/snippet.js?key="+e.zendeskKey,n.async=!0,n.id="ze-snippet",document.body.appendChild(n),window.zESettings=e.settings||{},()=>{document.body.removeChild(n)}},[e]),null}const r=e.createContext({client:void 0,me:void 0,publicConfig:void 0}),s=()=>t(r);function c(n){return e.createElement("div",{className:"spinner-wrapper"},e.createElement("style",null,`\n    .spinner-wrapper {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      height: 100vh;\n      flex-direction: column;\n    }\n    .spinner-text {\n      color: ${n.titleColor||"#255d91"};\n    }\n    .spinner {\n      width: ${n.size||"40px"};\n      height: ${n.size||"40px"};\n      position: relative;\n      margin: 10px auto;\n    }\n\n    .double-bounce1,\n    .double-bounce2 {\n      width: 100%;\n      height: 100%;\n      border-radius: 50%;\n      background-color: ${n.color||"#1890ff"};\n      opacity: 0.6;\n      position: absolute;\n      top: 0;\n      left: 0;\n\n      -webkit-animation: sk-bounce 2s infinite ease-in-out;\n      animation: sk-bounce 2s infinite ease-in-out;\n    }\n\n    .double-bounce2 {\n      -webkit-animation-delay: -1s;\n      animation-delay: -1s;\n    }\n\n    @-webkit-keyframes sk-bounce {\n      0%,\n      100% {\n        -webkit-transform: scale(0);\n      }\n      50% {\n        -webkit-transform: scale(1);\n      }\n    }\n\n    @keyframes sk-bounce {\n      0%,\n      100% {\n        transform: scale(0);\n        -webkit-transform: scale(0);\n      }\n      50% {\n        transform: scale(1);\n        -webkit-transform: scale(1);\n      }\n    }\n  `),e.createElement("div",{className:"spinner"},e.createElement("div",{className:"double-bounce1"}),e.createElement("div",{className:"double-bounce2"})),n.title&&e.createElement("p",{className:"spinner-text"},n.title))}function l(t){const[s,l]=e.useState(void 0),[d,u]=e.useState(void 0),[m,p]=e.useState(void 0),[f,b]=e.useState(!0);return n(()=>{const e=function(){const e=function(){const e=o.get("ember_simple_auth-session");if(e)try{var n;const t=JSON.parse(e);return null==t||null==(n=t.authenticated)?void 0:n.token}catch(e){return void console.error("Can not parse authentication information!")}}();return e?i("",{token:e}):void 0}();e?Promise.all([e.barista.get("/me/"),e.barista.get("/conf/public/")]).then(([n,t])=>{l(e),u(n.data),p(t.data),b(!1)}).catch(()=>{l(void 0),u(void 0),p(void 0),b(!1)}):(b(!1),l(void 0),u(void 0),p(void 0))},[]),f?e.createElement(c,{title:"Please Wait..."}):void 0===s||void 0===d||void 0===m?(window.location.href=`/webapps/waitress/production/?next=${window.location.href}`,null):e.createElement(r.Provider,{value:{client:s,me:d,publicConfig:m}},m.zendesk&&e.createElement(a,{zendeskKey:m.zendesk,settings:{contactForm:{fields:[{id:"name",prefill:{"*":d.fullname}},{id:"email",prefill:{"*":d.email}}]}}}),t.children)}export{l as DecafApp,c as DecafSpinner,a as ZendeskWidget,s as useDecaf};
//# sourceMappingURL=index.modern.js.map
